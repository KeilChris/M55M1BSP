<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>System Configuration</title>
<title>CMSIS-RTOS: System Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="cmsis.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<script type="text/javascript" src="cmsis_footer.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="CMSIS_Logo_Final.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">CMSIS-RTOS
   &#160;<span id="projectnumber">Version 1.03</span>
   </div>
   <div id="projectbrief">Real-Time Operating System: API and RTX Reference Implementation.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
    <ul class="tablist">
      <script type="text/javascript">
		<!--
		writeComponentTabs.call(this);
		//-->
      </script>
	  </ul>
</div>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('systemConfig.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">System Configuration </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The CMSIS-RTOS RTX provides system-wide settings for:</p><ul>
<li><a class="el" href="systemConfig.html#RoundRobin">Settings for Round-Robin Thread Switching</a></li>
<li><a class="el" href="systemConfig.html#UserTimer">User Timer Management</a></li>
</ul>
<h1><a class="anchor" id="RoundRobin"></a>
Settings for Round-Robin Thread Switching</h1>
<p>CMSIS-RTOS RTX may be configured to use round-robin multitasking thread switching. Round-robin allows quasi-parallel execution of several threads of the <em>same</em> priority. Threads are not really executed concurrently, but are scheduled where the available CPU time is divided into time slices and CMSIS-RTOS RTX assigns a time slice to each thread. Because the time slice is typically short (only a few milliseconds), it appears as though threads execute simultaneously.</p>
<p>Round-robin thread switching functions as follows:</p><ul>
<li>the tick is preloaded with the timeout value when a thread switch occurs</li>
<li>the tick is decremented (if not already zero) each system tick if the same thread is still executing</li>
<li>when the tick reaches 0 it indicates that a timeout has occurred. If there is another thread ready with the <em>same</em> priority, then the system switches to that thread and the tick is preloaded with timeout again.</li>
</ul>
<p>In other words, threads execute for the duration of their time slice (unless a thread's time slice is given up). Then, RTX switches to the next thread that is in <b>READY</b> state and has the same priority. If no other thread with the same priority is ready to run, the current running thread resumes it execution.</p>
<dl class="section note"><dt>Note</dt><dd>When switching to higher priority threads, the round-robin timeout value is reset.</dd></dl>
<p>Round-Robin multitasking is controlled with the <b>#define OS_ROBIN</b>. The time slice period is configured (in RTX Timer ticks) with the <b>#define OS_ROBINTOUT</b>.</p>
<p><b>Code Example:</b></p>
<p>The following example shows a simple CMSIS-RTOS RTX program that uses Round-Robin Multitasking. The two threads in this program are counter loops. RTX starts executing job 1, which is the function named job1. This function creates another task called job2. After job1 executes for its time slice, RTX switches to job2. After job2 executes for its time slice, RTX switches back to job1. This process repeats indefinitely.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cmsis__os_8h.html">cmsis_os.h</a>&quot;</span>                      <span class="comment">// CMSIS-RTOS header file</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> counter1;</div>
<div class="line"><span class="keywordtype">int</span> counter2;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> job1 (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <span class="keywordflow">while</span> (1) {                              <span class="comment">// loop forever</span></div>
<div class="line">    counter1++;                            <span class="comment">// update the counter</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> job2 (<span class="keywordtype">void</span> <span class="keyword">const</span> *arg) {</div>
<div class="line">  <span class="keywordflow">while</span> (1) {                              <span class="comment">// loop forever</span></div>
<div class="line">    counter2++;                            <span class="comment">// update the counter</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="group__CMSIS__RTOS__ThreadMgmt.html#gaee93d929beb350f16e5cc7fa602e229f">osThreadDef</a> (job1, <a class="code hl_enumvalue" href="cmsis__os_8h.html#ga7f2b42f1983b9107775ec2a1c69a849aa17b36cd9cd38652c2bc6d4803990674b">osPriorityAboveNormal</a>, 1, 0);</div>
<div class="line"><a class="code hl_define" href="group__CMSIS__RTOS__ThreadMgmt.html#gaee93d929beb350f16e5cc7fa602e229f">osThreadDef</a> (job2, <a class="code hl_enumvalue" href="cmsis__os_8h.html#ga7f2b42f1983b9107775ec2a1c69a849aa17b36cd9cd38652c2bc6d4803990674b">osPriorityAboveNormal</a>, 1, 0);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="group__CMSIS__RTOS__KernelCtrl.html#ga53d078a801022e202e8115c083ece68e">osKernelInitialize</a> ();                   <span class="comment">// setup kernel</span></div>
<div class="line">  <a class="code hl_function" href="group__CMSIS__RTOS__ThreadMgmt.html#gac59b5713cb083702dce759c73fd90dff">osThreadCreate</a> (<a class="code hl_define" href="group__CMSIS__RTOS__ThreadMgmt.html#gaf0c7c6b5e09f8be198312144b5c9e453">osThread</a>(job1), NULL);   <span class="comment">// create threads</span></div>
<div class="line">  <a class="code hl_function" href="group__CMSIS__RTOS__ThreadMgmt.html#gac59b5713cb083702dce759c73fd90dff">osThreadCreate</a> (<a class="code hl_define" href="group__CMSIS__RTOS__ThreadMgmt.html#gaf0c7c6b5e09f8be198312144b5c9e453">osThread</a>(job2), NULL); </div>
<div class="line">  <a class="code hl_function" href="group__CMSIS__RTOS__KernelCtrl.html#gaab668ffd2ea76bb0a77ab0ab385eaef2">osKernelStart</a> ();                        <span class="comment">// start kernel</span></div>
<div class="line">}</div>
<div class="ttc" id="acmsis__os_8h_html"><div class="ttname"><a href="cmsis__os_8h.html">cmsis_os.h</a></div></div>
<div class="ttc" id="acmsis__os_8h_html_ga7f2b42f1983b9107775ec2a1c69a849aa17b36cd9cd38652c2bc6d4803990674b"><div class="ttname"><a href="cmsis__os_8h.html#ga7f2b42f1983b9107775ec2a1c69a849aa17b36cd9cd38652c2bc6d4803990674b">osPriorityAboveNormal</a></div><div class="ttdeci">@ osPriorityAboveNormal</div><div class="ttdoc">priority: above normal</div><div class="ttdef"><b>Definition:</b> cmsis_os.h:85</div></div>
<div class="ttc" id="agroup__CMSIS__RTOS__KernelCtrl_html_ga53d078a801022e202e8115c083ece68e"><div class="ttname"><a href="group__CMSIS__RTOS__KernelCtrl.html#ga53d078a801022e202e8115c083ece68e">osKernelInitialize</a></div><div class="ttdeci">osStatus osKernelInitialize(void)</div><div class="ttdoc">Initialize the RTOS Kernel for creating objects.</div></div>
<div class="ttc" id="agroup__CMSIS__RTOS__KernelCtrl_html_gaab668ffd2ea76bb0a77ab0ab385eaef2"><div class="ttname"><a href="group__CMSIS__RTOS__KernelCtrl.html#gaab668ffd2ea76bb0a77ab0ab385eaef2">osKernelStart</a></div><div class="ttdeci">osStatus osKernelStart(void)</div><div class="ttdoc">Start the RTOS Kernel.</div></div>
<div class="ttc" id="agroup__CMSIS__RTOS__ThreadMgmt_html_gac59b5713cb083702dce759c73fd90dff"><div class="ttname"><a href="group__CMSIS__RTOS__ThreadMgmt.html#gac59b5713cb083702dce759c73fd90dff">osThreadCreate</a></div><div class="ttdeci">osThreadId osThreadCreate(const osThreadDef_t *thread_def, void *argument)</div><div class="ttdoc">Create a thread and add it to Active Threads and set it to state READY.</div></div>
<div class="ttc" id="agroup__CMSIS__RTOS__ThreadMgmt_html_gaee93d929beb350f16e5cc7fa602e229f"><div class="ttname"><a href="group__CMSIS__RTOS__ThreadMgmt.html#gaee93d929beb350f16e5cc7fa602e229f">osThreadDef</a></div><div class="ttdeci">#define osThreadDef(name, priority, instances, stacksz)</div><div class="ttdoc">Create a Thread Definition with function, priority, and stack requirements.</div><div class="ttdef"><b>Definition:</b> cmsis_os.h:278</div></div>
<div class="ttc" id="agroup__CMSIS__RTOS__ThreadMgmt_html_gaf0c7c6b5e09f8be198312144b5c9e453"><div class="ttname"><a href="group__CMSIS__RTOS__ThreadMgmt.html#gaf0c7c6b5e09f8be198312144b5c9e453">osThread</a></div><div class="ttdeci">#define osThread(name)</div><div class="ttdoc">Access a Thread definition.</div><div class="ttdef"><b>Definition:</b> cmsis_os.h:287</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Rather than waiting for a thread time slice to expire, use CMSIS-RTOS functions to signal to the RTX kernel that it can switch to another task. The function <a class="el" href="group__CMSIS__RTOS__ThreadMgmt.html#gaf13a667493c5d629a90c13e113b99233">osThreadYield</a> passes control to other threads without Round-Robin Multitasking.</dd></dl>
<h1><a class="anchor" id="UserTimer"></a>
User Timer Management</h1>
<p>CMSIS-RTOS RTX supports <a class="el" href="group__CMSIS__RTOS__TimerMgmt.html">Timer Management</a> which provides timer callback functions. The <a class="el" href="group__CMSIS__RTOS__TimerMgmt.html">Timer Management</a> is configured with the following <em>#defines:</em> </p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">#define   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">User Timers   </td><td class="markdownTableBodyNone"><code>OS_TIMERS</code>   </td><td class="markdownTableBodyNone">Enables the <a class="el" href="group__CMSIS__RTOS__TimerMgmt.html">Timer Management</a>. When disabled, the <b>osTimerThread</b> is not created.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Timer Thread Priority   </td><td class="markdownTableBodyNone"><code>OS_TIMERPRIO</code>   </td><td class="markdownTableBodyNone">Specifies the priority of the osTimerThread that executes the timer callback functions.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Timer Thread stack size [bytes]   </td><td class="markdownTableBodyNone"><code>OS_TIMERSTKSZ</code>   </td><td class="markdownTableBodyNone">Specifies the stack size (in words) for the the <b>osTimerThread</b>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Timer Callback Queue size   </td><td class="markdownTableBodyNone"><code>OS_TIMERCBQS</code>   </td><td class="markdownTableBodyNone">Specifies the maximum number of concurrent timer callbacks.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>Refer to <a class="el" href="theory.html#RTX_Threads">CMSIS-RTOS RTX Threads</a> for more information about the <b>osTimerThread</b>.</dd></dl>
<h1><a class="anchor" id="ISRFIFO"></a>
ISR FIFO Queue size</h1>
<p>ISR functions store requests to this buffer, when they are called from the interrupt handler. The default value for <b>#define OS_FIFOSZ</b> is 16. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">CMSIS-RTOS</a></li><li class="navelem"><a class="el" href="rtxImplementation.html">RTX Implementation</a></li><li class="navelem"><a class="el" href="configure.html">Configure RTX</a></li>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script>    
    </li>
  </ul>
</div>
</body>
</html>
